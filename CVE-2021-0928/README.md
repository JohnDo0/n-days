# CVE 2021 0928

> In createFromParcel of OutputConfiguration.java, there is a possible parcel serialization/deserialization mismatch due to improper input validation. This could lead to local escalation of privilege with no additional execution privileges needed. User interaction is not needed for exploitation.Product: AndroidVersions: Android-10 Android-11 Android-9Android ID: A-188675581

### Important links
- MITRE: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-0928
- Writeup: https://github.com/michalbednarski/ReparcelBug2
- `OutputConfiguration.java`: https://android.googlesource.com/platform/frameworks/base/+/refs/heads/android11-release/core/java/android/hardware/camera2/params/OutputConfiguration.java
- Parcel's: https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/os/Parcel.java

## TL;DR
An untrusted application can send an `itent` to the system application `android.hardware.camera2` with a malicious `parcel`, causing a serialisation mismatch, and can result in arbritary code being executed in the context of the user `system`.

The vulnerability lives in the class `android.hardware.camera2.params.OutputConfiguration` (code can be found in `core/java/android/hardware/camera2/params/OutputConfiguration.java`).